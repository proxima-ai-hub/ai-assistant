{"ast":null,"code":"import _asyncToGenerator from \"/Users/edubskiy/Dev/itmo/ai_assistant/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/user.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = function (a0, a1) {\n  return {\n    \"chat-message-bot\": a0,\n    \"chat-message-human\": a1\n  };\n};\nfunction MainComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10)(1, \"div\", 11)(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const item_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(2, _c0, item_r4.type === \"bot\", item_r4.type === \"human\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r4.text);\n  }\n}\nfunction MainComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"p\");\n    i0.ɵɵtext(2, \"\\u043F\\u0435\\u0447\\u0430\\u0442\\u0430\\u0435\\u0442...\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction MainComponent__svg_svg_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"svg\", 13);\n    i0.ɵɵelement(1, \"path\", 14)(2, \"rect\", 15);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MainComponent__svg_svg_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelementStart(0, \"svg\", 13);\n    i0.ɵɵelement(1, \"path\", 14)(2, \"path\", 16)(3, \"path\", 17)(4, \"path\", 18);\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    background: a0\n  };\n};\nexport class MainComponent {\n  constructor(service, fb) {\n    this.service = service;\n    this.fb = fb;\n    this.prompt = '';\n    this.messages = [];\n    this.istyping = false;\n    this.isPlaying = false;\n    this.sleep = ms => {\n      return new Promise(r => setTimeout(r, ms));\n    };\n  }\n  ngOnInit() {\n    this.getMessages();\n  }\n  getMessages() {\n    this.service.getMessages().subscribe(data => this.messages = data['message']);\n  }\n  sendMessage() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      if (!_this.prompt.trim() || _this.isPlaying) {\n        _this.prompt = '';\n        return;\n      }\n      _this.messages.push({\n        'text': _this.prompt,\n        'type': 'human'\n      });\n      const promptToSend = _this.prompt;\n      _this.isPlaying = true;\n      _this.prompt = '';\n      yield _this.sleep(2000);\n      _this.istyping = true;\n      if (promptToSend) {\n        const data = _this.fb.group({\n          text: promptToSend\n        });\n        _this.service.handle_post_requests(data.value, 'generateText').subscribe(response => {\n          _this.checkTaskStatus(response['task_id']);\n        }, /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (err) {\n            yield _this.sleep(2000);\n            _this.istyping = false;\n            _this.messages.push({\n              'text': \"Извините, мы позже вернемся к Вашему вопросу.\",\n              'type': 'bot'\n            });\n            console.error('Error sending message: ', err);\n            _this.isPlaying = false;\n          });\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      }\n    })();\n  }\n  checkTaskStatus(task_id) {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      yield _this2.sleep(5000);\n      _this2.service.handle_get_requests(task_id, 'task').subscribe(response => {\n        _this2.istyping = false;\n        _this2.messages.push({\n          'text': response['result'],\n          'type': 'bot'\n        });\n        _this2.isPlaying = false;\n      });\n    })();\n  }\n  static #_ = this.ɵfac = function MainComponent_Factory(t) {\n    return new (t || MainComponent)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.FormBuilder));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MainComponent,\n    selectors: [[\"app-main\"]],\n    decls: 15,\n    vars: 8,\n    consts: [[1, \"container\"], [1, \"messages\", \"mat-elevation-z5\"], [1, \"messages-header\"], [1, \"chatbox\"], [3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"chat-typing\", 4, \"ngIf\"], [1, \"wrapper\"], [\"type\", \"text\", \"placeholder\", \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435\", 3, \"ngModel\", \"ngModelChange\"], [3, \"ngStyle\", \"click\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"16\", \"height\", \"16\", \"viewBox\", \"0 0 24 24\", \"stroke-width\", \"2\", \"stroke\", \"currentColor\", \"fill\", \"none\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\", 4, \"ngIf\"], [3, \"ngClass\"], [1, \"details\"], [1, \"chat-typing\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", \"width\", \"16\", \"height\", \"16\", \"viewBox\", \"0 0 24 24\", \"stroke-width\", \"2\", \"stroke\", \"currentColor\", \"fill\", \"none\", \"stroke-linecap\", \"round\", \"stroke-linejoin\", \"round\"], [\"stroke\", \"none\", \"d\", \"M0 0h24v24H0z\", \"fill\", \"none\"], [\"x\", \"6\", \"y\", \"6\", \"width\", \"12\", \"height\", \"12\", \"rx\", \"2\"], [\"d\", \"M5 12l14 0\"], [\"d\", \"M13 18l6 -6\"], [\"d\", \"M13 6l6 6\"]],\n    template: function MainComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"h2\");\n        i0.ɵɵtext(4, \"\\u0410\\u0441\\u0441\\u0438\\u0441\\u0442\\u0435\\u043D\\u0442\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(5, \"hr\");\n        i0.ɵɵelementStart(6, \"div\", 3);\n        i0.ɵɵtemplate(7, MainComponent_div_7_Template, 4, 5, \"div\", 4);\n        i0.ɵɵtemplate(8, MainComponent_div_8_Template, 3, 0, \"div\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(9, \"hr\");\n        i0.ɵɵelementStart(10, \"div\", 6)(11, \"input\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function MainComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.prompt = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function MainComponent_Template_button_click_12_listener() {\n          return ctx.sendMessage();\n        });\n        i0.ɵɵtemplate(13, MainComponent__svg_svg_13_Template, 3, 0, \"svg\", 9);\n        i0.ɵɵtemplate(14, MainComponent__svg_svg_14_Template, 5, 0, \"svg\", 9);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", ctx.messages);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.istyping);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.prompt);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(6, _c1, ctx.isPlaying ? \"white\" : ctx.prompt ? \"white\" : \"#686868\"));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isPlaying);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isPlaying);\n      }\n    },\n    dependencies: [i3.NgClass, i3.NgForOf, i3.NgIf, i3.NgStyle, i2.DefaultValueAccessor, i2.NgControlStatus, i2.NgModel],\n    styles: [\"*[_ngcontent-%COMP%] {\\n  box-sizing: border-box;\\n}\\n\\n.container[_ngcontent-%COMP%] {\\n  display: flex;\\n  height: calc(100vh - 10px);\\n  flex-direction: column;\\n  align-items: center;\\n}\\n\\n.messages[_ngcontent-%COMP%] {\\n  width: 40%;\\n  margin: 16px;\\n  margin-top: 8%;\\n  background: rgb(26, 26, 26);\\n  border-radius: 16px;\\n  padding: 24px;\\n}\\n\\n.messages-header[_ngcontent-%COMP%] {\\n  display: flex;\\n  margin-bottom: 8px;\\n}\\n.messages-header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n  border-radius: 50%;\\n  object-fit: cover;\\n  margin-right: 16px;\\n  height: 35px;\\n}\\n.messages-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  margin: 0;\\n  color: #ff5533;\\n}\\n\\n.chatbox[_ngcontent-%COMP%] {\\n  padding: 15px;\\n  list-style: none;\\n  overflow-y: auto;\\n  height: 400px;\\n  background-color: #262a2f;\\n  border-top-left-radius: 5px;\\n  border-top-right-radius: 5px;\\n  border-bottom-left-radius: 5px;\\n  border-bottom-right-radius: 5px;\\n  scrollbar-width: none;\\n}\\n.chatbox[_ngcontent-%COMP%]   .chat-message-bot[_ngcontent-%COMP%] {\\n  display: flex;\\n}\\n.chatbox[_ngcontent-%COMP%]   .chat-message-bot[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%] {\\n  margin-right: auto;\\n  max-width: calc(100% - 130px);\\n}\\n.chatbox[_ngcontent-%COMP%]   .chat-message-bot[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\\n  border-radius: 18px 18px 18px 0;\\n}\\n.chatbox[_ngcontent-%COMP%]   .chat-message-human[_ngcontent-%COMP%] {\\n  display: flex;\\n}\\n.chatbox[_ngcontent-%COMP%]   .chat-message-human[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%] {\\n  margin-left: auto;\\n  max-width: calc(100% - 130px);\\n}\\n.chatbox[_ngcontent-%COMP%]   .chat-message-human[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\\n  border-radius: 18px 18px 0 18px;\\n  background-color: #ff5533 !important;\\n  color: rgb(26, 26, 26);\\n}\\n.chatbox[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\\n  margin: 10px 0 0px 0;\\n  padding: 8px 16px;\\n  border-radius: 10px;\\n  word-wrap: break-word;\\n  background-color: #eaeaea;\\n}\\n.chatbox[_ngcontent-%COMP%]   .chat-typing[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\\n  font-style: italic;\\n  color: gray;\\n  animation: _ngcontent-%COMP%_blink 1s infinite;\\n  width: 40%;\\n  border-radius: 18px 18px 18px 0;\\n}\\n@keyframes _ngcontent-%COMP%_blink {\\n  0%, 100% {\\n    opacity: 1;\\n  }\\n  50% {\\n    opacity: 0.5;\\n  }\\n}\\n\\n.chat-outgoing[_ngcontent-%COMP%]   p[_ngcontent-%COMP%] {\\n  background-color: #162887;\\n  align-self: flex-end;\\n  color: #fff;\\n}\\n\\nhr[_ngcontent-%COMP%] {\\n  display: block;\\n  height: 1px;\\n  border: 0;\\n  border-top: 1px solid #ff5533;\\n}\\n\\n.wrapper[_ngcontent-%COMP%] {\\n  width: 400px;\\n  max-width: 100%;\\n  position: relative;\\n  margin-top: 20px;\\n  display: flex;\\n  align-items: center;\\n}\\n.wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%] {\\n  color: #E5E5E5;\\n  font-size: 16px;\\n  background: #262a2f;\\n  border: 1px solid #686868;\\n  border-radius: 50px;\\n  padding: 10px 16px;\\n  width: 100%;\\n  outline: none;\\n}\\n.wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  background: #686868;\\n  border-radius: 50px;\\n  aspect-ratio: 1;\\n  height: 80%;\\n  position: absolute;\\n  top: 10%;\\n  right: 5px;\\n  border: none;\\n  cursor: pointer;\\n  transition: background-color 0.3s ease;\\n}\\n.wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover {\\n  opacity: 0.8;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbWFpbi9tYWluLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQU9BO0VBQ0Usc0JBQUE7QUFORjs7QUFTQTtFQUNFLGFBQUE7RUFDQSwwQkFBQTtFQUNBLHNCQUFBO0VBQ0EsbUJBQUE7QUFORjs7QUFTQTtFQUNFLFVBQUE7RUFDQSxZQUFBO0VBQ0EsY0FBQTtFQUNBLDJCQXJCTTtFQXNCTixtQkFBQTtFQUNBLGFBQUE7QUFORjs7QUFTQTtFQUVFLGFBQUE7RUFDQSxrQkFBQTtBQVBGO0FBU0U7RUFDRSxrQkFBQTtFQUNBLGlCQUFBO0VBQ0Esa0JBQUE7RUFDQSxZQUFBO0FBUEo7QUFVRTtFQUNFLFNBQUE7RUFDQSxjQXJDSztBQTZCVDs7QUFZQTtFQUVFLGFBQUE7RUFDQSxnQkFBQTtFQUNBLGdCQUFBO0VBQ0EsYUFBQTtFQUNBLHlCQWpESztFQWtETCwyQkFBQTtFQUNBLDRCQUFBO0VBQ0EsOEJBQUE7RUFDQSwrQkFBQTtFQUNBLHFCQUFBO0FBVkY7QUFZRTtFQUNFLGFBQUE7QUFWSjtBQVlJO0VBQ0Usa0JBQUE7RUFDQSw2QkFBQTtBQVZOO0FBWU07RUFDRSwrQkFBQTtBQVZSO0FBZUU7RUFDRSxhQUFBO0FBYko7QUFlSTtFQUNFLGlCQUFBO0VBQ0EsNkJBQUE7QUFiTjtBQWVNO0VBQ0UsK0JBQUE7RUFDQSxvQ0FBQTtFQUNBLHNCQWhGQTtBQW1FUjtBQWtCRTtFQUNFLG9CQUFBO0VBQ0EsaUJBQUE7RUFDQSxtQkFBQTtFQUNBLHFCQUFBO0VBQ0EseUJBQUE7QUFoQko7QUFtQkU7RUFDRSxrQkFBQTtFQUNBLFdBQUE7RUFDQSw0QkFBQTtFQUNBLFVBQUE7RUFDQSwrQkFBQTtBQWpCSjtBQW9CRTtFQUVFO0lBRUUsVUFBQTtFQXBCSjtFQXVCRTtJQUNFLFlBQUE7RUFyQko7QUFDRjs7QUF5QkE7RUFDRSx5QkFBQTtFQUNBLG9CQUFBO0VBQ0EsV0FBQTtBQXRCRjs7QUF5QkE7RUFDRSxjQUFBO0VBQ0EsV0FBQTtFQUNBLFNBQUE7RUFDQSw2QkFBQTtBQXRCRjs7QUF5QkE7RUFDRSxZQUFBO0VBQ0EsZUFBQTtFQUNBLGtCQUFBO0VBRUEsZ0JBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7QUF2QkY7QUF5QkU7RUFDRSxjQTFJSTtFQTJJSixlQUFBO0VBQ0EsbUJBMUlHO0VBMklILHlCQUFBO0VBQ0EsbUJBQUE7RUFDQSxrQkFBQTtFQUNBLFdBQUE7RUFDQSxhQUFBO0FBdkJKO0FBMEJFO0VBQ0UsbUJBbEpTO0VBbUpULG1CQUFBO0VBQ0EsZUFBQTtFQUNBLFdBQUE7RUFDQSxrQkFBQTtFQUNBLFFBQUE7RUFDQSxVQUFBO0VBQ0EsWUFBQTtFQUNBLGVBQUE7RUFDQSxzQ0FBQTtBQXhCSjtBQTBCSTtFQUNFLFlBQUE7QUF4Qk4iLCJzb3VyY2VzQ29udGVudCI6WyIkd2hpdGU6ICNFNUU1RTU7XG4kYmxhY2s6IHJnYigyNiwgMjYsIDI2KTtcbiRncmF5OiAjMjYyYTJmO1xuJGdyYXlfbGlnaHQ6ICM2ODY4Njg7XG4kb3JhbmdlOiAjZmY1NTMzO1xuJGZvbnQtZmFtaWx5OiBcIlJvYm90byBNb25vXCIsIG1vbm9zcGFjZTtcblxuKiB7XG4gIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XG59XG5cbi5jb250YWluZXIge1xuICBkaXNwbGF5OiBmbGV4O1xuICBoZWlnaHQ6IGNhbGMoMTAwdmggLSAxMHB4KTtcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbn1cblxuLm1lc3NhZ2VzIHtcbiAgd2lkdGg6IDQwJTtcbiAgbWFyZ2luOiAxNnB4O1xuICBtYXJnaW4tdG9wOiA4JTtcbiAgYmFja2dyb3VuZDogJGJsYWNrO1xuICBib3JkZXItcmFkaXVzOiAxNnB4O1xuICBwYWRkaW5nOiAyNHB4O1xufVxuXG4ubWVzc2FnZXMtaGVhZGVyIHtcblxuICBkaXNwbGF5OiBmbGV4O1xuICBtYXJnaW4tYm90dG9tOiA4cHg7XG5cbiAgaW1nIHtcbiAgICBib3JkZXItcmFkaXVzOiA1MCU7XG4gICAgb2JqZWN0LWZpdDogY292ZXI7XG4gICAgbWFyZ2luLXJpZ2h0OiAxNnB4O1xuICAgIGhlaWdodDogMzVweDtcbiAgfVxuXG4gIGgyIHtcbiAgICBtYXJnaW46IDA7XG4gICAgY29sb3I6ICRvcmFuZ2U7XG4gIH1cbn1cblxuLmNoYXRib3gge1xuXG4gIHBhZGRpbmc6IDE1cHg7XG4gIGxpc3Qtc3R5bGU6IG5vbmU7XG4gIG92ZXJmbG93LXk6IGF1dG87XG4gIGhlaWdodDogNDAwcHg7XG4gIGJhY2tncm91bmQtY29sb3I6ICRncmF5O1xuICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiA1cHg7XG4gIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiA1cHg7XG4gIGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6IDVweDtcbiAgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6IDVweDtcbiAgc2Nyb2xsYmFyLXdpZHRoOiBub25lO1xuXG4gIC5jaGF0LW1lc3NhZ2UtYm90IHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuXG4gICAgLmRldGFpbHMge1xuICAgICAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xuICAgICAgbWF4LXdpZHRoOiBjYWxjKDEwMCUgLSAxMzBweCk7XG5cbiAgICAgIHAge1xuICAgICAgICBib3JkZXItcmFkaXVzOiAxOHB4IDE4cHggMThweCAwO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC5jaGF0LW1lc3NhZ2UtaHVtYW4ge1xuICAgIGRpc3BsYXk6IGZsZXg7XG5cbiAgICAuZGV0YWlscyB7XG4gICAgICBtYXJnaW4tbGVmdDogYXV0bztcbiAgICAgIG1heC13aWR0aDogY2FsYygxMDAlIC0gMTMwcHgpO1xuXG4gICAgICBwIHtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMThweCAxOHB4IDAgMThweDtcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogJG9yYW5nZSAhaW1wb3J0YW50O1xuICAgICAgICBjb2xvcjogJGJsYWNrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHAge1xuICAgIG1hcmdpbjogMTBweCAwIDBweCAwO1xuICAgIHBhZGRpbmc6IDhweCAxNnB4O1xuICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7XG4gICAgd29yZC13cmFwOiBicmVhay13b3JkO1xuICAgIGJhY2tncm91bmQtY29sb3I6ICNlYWVhZWE7XG4gIH1cblxuICAuY2hhdC10eXBpbmcgcCB7XG4gICAgZm9udC1zdHlsZTogaXRhbGljO1xuICAgIGNvbG9yOiBncmF5O1xuICAgIGFuaW1hdGlvbjogYmxpbmsgMXMgaW5maW5pdGU7XG4gICAgd2lkdGg6IDQwJTtcbiAgICBib3JkZXItcmFkaXVzOiAxOHB4IDE4cHggMThweCAwO1xuICB9XG5cbiAgQGtleWZyYW1lcyBibGluayB7XG5cbiAgICAwJSxcbiAgICAxMDAlIHtcbiAgICAgIG9wYWNpdHk6IDE7XG4gICAgfVxuXG4gICAgNTAlIHtcbiAgICAgIG9wYWNpdHk6IDAuNTtcbiAgICB9XG4gIH1cbn1cblxuLmNoYXQtb3V0Z29pbmcgcCB7XG4gIGJhY2tncm91bmQtY29sb3I6ICMxNjI4ODc7XG4gIGFsaWduLXNlbGY6IGZsZXgtZW5kO1xuICBjb2xvcjogI2ZmZjtcbn1cblxuaHIge1xuICBkaXNwbGF5OiBibG9jaztcbiAgaGVpZ2h0OiAxcHg7XG4gIGJvcmRlcjogMDtcbiAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICRvcmFuZ2U7XG59XG5cbi53cmFwcGVyIHtcbiAgd2lkdGg6IDQwMHB4O1xuICBtYXgtd2lkdGg6IDEwMCU7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcblxuICBtYXJnaW4tdG9wOiAyMHB4O1xuICBkaXNwbGF5OiBmbGV4O1xuICBhbGlnbi1pdGVtczogY2VudGVyO1xuXG4gIGlucHV0IHtcbiAgICBjb2xvcjogJHdoaXRlO1xuICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICBiYWNrZ3JvdW5kOiAkZ3JheTtcbiAgICBib3JkZXI6IDFweCBzb2xpZCAkZ3JheV9saWdodDtcbiAgICBib3JkZXItcmFkaXVzOiA1MHB4O1xuICAgIHBhZGRpbmc6IDEwcHggMTZweDtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBvdXRsaW5lOiBub25lO1xuICB9XG5cbiAgYnV0dG9uIHtcbiAgICBiYWNrZ3JvdW5kOiAkZ3JheV9saWdodDtcbiAgICBib3JkZXItcmFkaXVzOiA1MHB4O1xuICAgIGFzcGVjdC1yYXRpbzogMTtcbiAgICBoZWlnaHQ6IDgwJTtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiAxMCU7XG4gICAgcmlnaHQ6IDVweDtcbiAgICBib3JkZXI6IG5vbmU7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4zcyBlYXNlO1xuXG4gICAgJjpob3ZlciB7XG4gICAgICBvcGFjaXR5OiAwLjg7XG4gICAgfVxuICAgIFxuICB9XG5cblxufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n  });\n}","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","ɵɵpureFunction2","_c0","item_r4","type","ɵɵadvance","ɵɵtextInterpolate","text","ɵɵnamespaceSVG","ɵɵelement","MainComponent","constructor","service","fb","prompt","messages","istyping","isPlaying","sleep","ms","Promise","r","setTimeout","ngOnInit","getMessages","subscribe","data","sendMessage","_this","_asyncToGenerator","trim","push","promptToSend","group","handle_post_requests","value","response","checkTaskStatus","_ref","err","console","error","_x","apply","arguments","task_id","_this2","handle_get_requests","_","ɵɵdirectiveInject","i1","UserService","i2","FormBuilder","_2","selectors","decls","vars","consts","template","MainComponent_Template","rf","ctx","ɵɵtemplate","MainComponent_div_7_Template","MainComponent_div_8_Template","ɵɵlistener","MainComponent_Template_input_ngModelChange_11_listener","$event","MainComponent_Template_button_click_12_listener","MainComponent__svg_svg_13_Template","MainComponent__svg_svg_14_Template","ɵɵpureFunction1","_c1"],"sources":["/Users/edubskiy/Dev/itmo/ai_assistant/frontend/src/app/main/main.component.ts","/Users/edubskiy/Dev/itmo/ai_assistant/frontend/src/app/main/main.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { UserService } from '../services/user.service';\nimport { FormBuilder } from '@angular/forms';\nimport { MessageModel } from '../models/message';\n\n@Component({\n  selector: 'app-main',\n\n  templateUrl: './main.component.html',\n  styleUrls: ['./main.component.scss']\n})\nexport class MainComponent implements OnInit {\n\n  prompt: string = '';\n  messages: MessageModel[] = [];\n  istyping: boolean = false;\n  isPlaying: boolean = false;\n\n  public sleep = (ms: number): Promise<void> => { return new Promise((r) => setTimeout(r, ms)); }\n\n  constructor(private service: UserService, private fb: FormBuilder) { }\n\n  ngOnInit(): void { this.getMessages(); }\n\n  getMessages(): void {\n    this.service.getMessages().subscribe(\n      data => this.messages = data['message']);\n  }\n\n  async sendMessage() {\n    if (!this.prompt.trim() || this.isPlaying) {\n      this.prompt='';\n      return;\n    }\n\n    this.messages.push({ 'text': this.prompt, 'type': 'human' })\n    \n    const promptToSend = this.prompt;\n    \n    this.isPlaying = true;\n    \n    this.prompt = '';\n    \n    await this.sleep(2000);\n    \n    this.istyping = true;\n    \n    if (promptToSend) {\n\n      const data = this.fb.group({ text: promptToSend });\n      this.service.handle_post_requests(data.value, 'generateText').subscribe(response => {\n        this.checkTaskStatus(response['task_id']);\n      \n      }, async (err) => {\n      \n        await this.sleep(2000);\n        this.istyping = false;\n        this.messages.push({ 'text': \"Извините, мы позже вернемся к Вашему вопросу.\", 'type': 'bot' })\n        console.error('Error sending message: ', err);\n        this.isPlaying = false;\n      \n      });\n    }\n\n  }\n\n  async checkTaskStatus(task_id: string) {\n    await this.sleep(5000)\n    this.service.handle_get_requests(task_id, 'task').subscribe(response => {\n      this.istyping = false;\n      this.messages.push({ 'text': response['result'], 'type': 'bot' })\n      this.isPlaying = false;\n    });\n  }\n}\n\n\n\n","<div class=\"container\">\n    <div class=\"messages mat-elevation-z5\">\n        <div class=\"messages-header\">\n            <!-- <img  src=\"assets/bot.jpeg\" alt=\"bot_img\"> -->\n            <h2>Ассистент</h2>\n        </div>\n        <hr>\n        <div class=\"chatbox\">\n            <div *ngFor=\"let item of messages\" [ngClass]=\"{\n                    'chat-message-bot': item.type === 'bot',\n                    'chat-message-human': item.type === 'human'\n                }\">\n                <div class=\"details\">\n                    <p>{{item.text}}</p>\n                </div>\n            </div>\n\n            <div class=\"chat-typing\" *ngIf=\"istyping\">\n                <p>печатает...</p>\n            </div>\n        </div>\n        <hr>\n\n        \n        <div class=\"wrapper\">\n            <input type=\"text\" [(ngModel)]=\"prompt\" placeholder=\"Введите\" />\n            <button (click)=\"sendMessage()\"\n                [ngStyle]=\"{background: isPlaying ? 'white' : (prompt ? 'white' : '#686868')}\">\n                <svg *ngIf=\"isPlaying\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"\n                    stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n                    <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n                    <rect x=\"6\" y=\"6\" width=\"12\" height=\"12\" rx=\"2\"></rect>\n                </svg>\n                <svg *ngIf=\"!isPlaying\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\"\n                    stroke-width=\"2\" stroke=\"currentColor\" fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n                    <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n                    <path d=\"M5 12l14 0\"></path>\n                    <path d=\"M13 18l6 -6\"></path>\n                    <path d=\"M13 6l6 6\"></path>\n                </svg>\n            </button>\n        </div>\n\n\n\n    </div>\n</div>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}